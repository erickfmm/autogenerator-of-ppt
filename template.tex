\documentclass[aspectratio=169]{beamer}

% Tema moderno y lÃºdico
\usetheme{Boadilla}
\usecolortheme{dolphin}

% Paquetes esenciales
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{tikz}
\usetikzlibrary{shapes, arrows, positioning, calc}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{pgf-pie}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{newunicodechar}

% Configurar emojis como texto simple
\newunicodechar{ğŸ²}{\textsf{[dado]}}
\newunicodechar{ğŸ¯}{\textsf{[objetivo]}}
\newunicodechar{ğŸ“‹}{\textsf{[lista]}}
\newunicodechar{â­}{\textsf{[estrella]}}
\newunicodechar{ğŸ”®}{\textsf{[bola]}}
\newunicodechar{ğŸ“}{\textsf{[regla]}}
\newunicodechar{ğŸƒ}{\textsf{[carta]}}
\newunicodechar{ğŸ”„}{\textsf{[ciclo]}}
\newunicodechar{ğŸ”¢}{\textsf{[numeros]}}
\newunicodechar{â•}{\textsf{[+]}}
\newunicodechar{âœ–}{\textsf{[x]}}
\newunicodechar{ğŸ”—}{\textsf{[cadena]}}
\newunicodechar{ğŸª™}{\textsf{[moneda]}}
\newunicodechar{ğŸ”‘}{\textsf{[llave]}}
\newunicodechar{ğŸ”}{\textsf{[lupa]}}
\newunicodechar{ğŸ“Š}{\textsf{[grafico]}}
\newunicodechar{ğŸ´}{\textsf{[cartas]}}
\newunicodechar{ğŸ’ª}{\textsf{[fuerza]}}
\newunicodechar{ğŸŒŸ}{\textsf{[estrella]}}
\newunicodechar{ğŸ’¡}{\textsf{[idea]}}
\newunicodechar{âœ¨}{\textsf{[brillos]}}
\newunicodechar{âœ…}{\textsf{[check]}}
\newunicodechar{ğŸ“}{\textsf{[gorro]}}
\newunicodechar{ğŸ¤”}{\textsf{[pensar]}}
\newunicodechar{ğŸš€}{\textsf{[cohete]}}
\newunicodechar{â™¥}{\ensuremath{\heartsuit}}
\newunicodechar{â‚}{\textsubscript{1}}
\newunicodechar{â‚‚}{\textsubscript{2}}
\newunicodechar{âœ–}{\textsf{x}}
\newunicodechar{âœ“}{\textsf{[ok]}}
\newunicodechar{âš«}{\textsf{[punto]}}
\newunicodechar{ğŸ‘¥}{\textsf{[grupo]}}
\newunicodechar{ï¸}{}

% Colores personalizados vibrantes y lÃºdicos
\definecolor{colorPrimario}{RGB}{41, 128, 185}      % Azul vibrante
\definecolor{colorSecundario}{RGB}{231, 76, 60}     % Rojo coral
\definecolor{colorAccento}{RGB}{46, 204, 113}       % Verde esmeralda
\definecolor{colorAdvertencia}{RGB}{241, 196, 15}   % Amarillo dorado
\definecolor{colorMorado}{RGB}{155, 89, 182}        % Morado amigable
\definecolor{colorNaranja}{RGB}{230, 126, 34}       % Naranja cÃ¡lido
\definecolor{colorFondo}{RGB}{236, 240, 241}        % Gris claro de fondo

% ConfiguraciÃ³n del tema
\setbeamercolor{structure}{fg=colorPrimario}
\setbeamercolor{palette primary}{bg=colorPrimario,fg=white}
\setbeamercolor{palette secondary}{bg=colorSecundario,fg=white}
\setbeamercolor{palette tertiary}{bg=colorAccento,fg=white}
\setbeamercolor{block title}{bg=colorPrimario!90,fg=white}
\setbeamercolor{block body}{bg=colorPrimario!10,fg=black}
\setbeamercolor{block title example}{bg=colorAccento!90,fg=white}
\setbeamercolor{block body example}{bg=colorAccento!10,fg=black}
\setbeamercolor{block title alerted}{bg=colorSecundario!90,fg=white}
\setbeamercolor{block body alerted}{bg=colorSecundario!10,fg=black}

% Plantillas personalizadas
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}[frame number]
\setbeamertemplate{itemize items}[circle]
\setbeamertemplate{enumerate items}[circle]
\setbeamerfont{title}{size=\huge,series=\bfseries}
\setbeamerfont{frametitle}{size=\Large,series=\bfseries}

% Comandos personalizados para Ã©nfasis
\renewcommand{\alert}[1]{\textcolor{colorSecundario}{\textbf{#1}}}
\newcommand{\highlight}[1]{\textcolor{colorPrimario}{\textbf{#1}}}
\newcommand{\importante}[1]{\textcolor{colorAdvertencia}{\textbf{#1}}}
\newcommand{\exito}[1]{\textcolor{colorAccento}{\textbf{#1}}}

% Variables del documento (serÃ¡n reemplazadas por Jinja2)
\title{<< tema >>}
\subtitle{<< subtitulo >>}
\author{Probabilidad y EstadÃ­stica}
\institute{Aprendiendo con diversiÃ³n ğŸ“}
\date{\today}

\begin{document}

% PÃ¡gina de tÃ­tulo con diseÃ±o atractivo
\begin{frame}[plain]
\begin{tikzpicture}[remember picture,overlay]
  % Fondo decorativo
  \fill[colorPrimario!20] (current page.south west) rectangle (current page.north east);
  \fill[colorAccento!30] (current page.south west) -- (current page.south east) -- 
        ([yshift=-3cm]current page.north east) -- ([yshift=-3cm]current page.north west) -- cycle;
\end{tikzpicture}
\titlepage
\end{frame}

% Diapositivas generadas dinÃ¡micamente
<<% for slide in diapositivas %>>
\begin{frame}[fragile]{<< slide.titulo >>}
<<% for item in slide.contenido %>>
<<% if item is string %>>
\begin{itemize}
  \item << item >>
\end{itemize}

<<% elif item.tipo == "ejemplo" %>>
\begin{exampleblock}{âœ¨ Ejemplo}
<< item.texto >>
\end{exampleblock}

<<% elif item.tipo == "formula" %>>
\begin{center}
\colorbox{colorFondo}{%
  \parbox{0.8\textwidth}{%
    \begin{center}
    \Large\color{colorPrimario}
    $<< item.texto >>$
    \end{center}
  }%
}
\end{center}

<<% elif item.tipo == "calculo" %>>
\begin{center}
\colorbox{colorFondo}{%
  \parbox{0.9\textwidth}{%
    \begin{align*}
    << item.texto >>
    \end{align*}
  }%
}
\end{center}

<<% elif item.tipo == "nota" %>>
\begin{alertblock}{ğŸ’¡ Nota importante}
<< item.texto >>
\end{alertblock}

<<% elif item.tipo == "problema" %>>
\begin{exampleblock}{ğŸ¯ Problema}
<< item.texto >>
\end{exampleblock}

<<% elif item.tipo == "tabla" %>>
\begin{center}
\begin{tabular}{<<% for h in item.encabezados %>>c<<% endfor %>>}
\toprule
\rowcolor{colorPrimario!20}
<<% for h in item.encabezados %>>\textbf{<< h >>}<<% if not loop.last %>> & <<% endif %>><<% endfor %>> \\
\midrule
<<% for fila in item.filas %>>
<<% if loop.index is odd %>>
\rowcolor{colorFondo}
<<% endif %>>
<<% for celda in fila %>><< celda >><<% if not loop.last %>> & <<% endif %>><<% endfor %>> \\
<<% endfor %>>
\bottomrule
\end{tabular}
\end{center}

<<% elif item.tipo == "componentes" %>>
\begin{itemize}
<<% for comp in item.lista %>>
  \item << comp >>
<<% endfor %>>
\end{itemize}

<<% elif item.tipo == "solucion" %>>
\begin{block}{âœ… SoluciÃ³n}
\begin{enumerate}
<<% for paso in item.pasos %>>
  \item << paso >>
<<% endfor %>>
\end{enumerate}
\end{block}

<<% elif item.tipo == "grafico_barras" %>>
\begin{center}
\begin{tikzpicture}
  \begin{axis}[
    ybar,
    width=0.8\textwidth,
    height=0.45\textheight,
    bar width=<<% if item.ancho_barra %>><< item.ancho_barra >><<% else %>>15pt<<% endif %>>,
    ylabel={<< item.etiqueta_y >>},
    xlabel={<< item.etiqueta_x >>},
    symbolic x coords={<<% for label in item.categorias %>><< label >><<% if not loop.last %>>,<<% endif %>><<% endfor %>>},
    xtick=data,
    x tick label style={rotate=45, anchor=east},
    ymin=0,
    enlarge x limits=0.15,
    legend style={at={(0.5,-0.25)}, anchor=north, legend columns=-1},
    nodes near coords,
    every node near coord/.append style={font=\footnotesize},
    grid=major,
    ymajorgrids=true,
    grid style={dashed,gray!30}
  ]
  \addplot[fill=colorPrimario!70] coordinates {
    <<% for i in range(item.categorias|length) %>>
    (<< item.categorias[i] >>,<< item.valores[i] >>)
    <<% endfor %>>
  };
  <<% if item.titulo_serie %>>
  \legend{<< item.titulo_serie >>}
  <<% endif %>>
  \end{axis}
\end{tikzpicture}
\end{center}
<<% elif item.tipo == "grafico_lineas" %>>
\begin{center}
\begin{tikzpicture}
  \begin{axis}[
    width=0.85\textwidth,
    height=0.6\textheight,
    ylabel={<< item.etiqueta_y >>},
    xlabel={<< item.etiqueta_x >>},
    grid=both,
    major grid style={line width=.2pt,draw=gray!50},
    minor grid style={line width=.1pt,draw=gray!20},
    legend pos=<<% if item.posicion_leyenda %>><< item.posicion_leyenda >><<% else %>>north west<<% endif %>>,
    mark size=3pt,
    line width=2pt
  ]
  \addplot[color=colorPrimario, mark=*] coordinates {
    <<% for i in range(item.datos_x|length) %>>
    (<< item.datos_x[i] >>,<< item.datos_y[i] >>)
    <<% endfor %>>
  };
  <<% if item.titulo_serie %>>
  \legend{<< item.titulo_serie >>}
  <<% endif %>>
  \end{axis}
\end{tikzpicture}
\end{center}
<<% elif item.tipo == "grafico_circular" %>>
\begin{center}
\begin{tikzpicture}
  \pie[
    radius=3,
    text=legend,
    color={colorPrimario!70, colorAccento!70, colorSecundario!70, colorAdvertencia!70, colorMorado!70, colorNaranja!70}
  ]{
    <<% for i in range(item.valores|length) %>>
    << item.valores[i] >>/<< item.etiquetas[i] >><<% if not loop.last %>>,<<% endif %>>
    <<% endfor %>>
  }
\end{tikzpicture}
\end{center}
<<% endif %>>
<<% endfor %>>
\end{frame}

<<% endfor %>>

% Diapositiva final atractiva
\begin{frame}[plain]
\begin{tikzpicture}[remember picture,overlay]
  \fill[colorAccento!20] (current page.south west) rectangle (current page.north east);
  \node[font=\Huge\bfseries,text=colorPrimario] at (current page.center) {Â¿Preguntas? ğŸ¤”};
  \node[font=\large,text=colorSecundario,below=1.5cm] at (current page.center) {Â¡Sigue aprendiendo! ğŸš€};
\end{tikzpicture}
\end{frame}

\end{document}
